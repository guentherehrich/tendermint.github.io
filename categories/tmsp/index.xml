<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Tmsp on Tendermint</title>
    <link>http://tendermint.com/categories/tmsp/</link>
    <description>Recent content in Tmsp on Tendermint</description>
    <generator>Hugo -- gohugo.io</generator>
    <lastBuildDate>Sat, 19 Dec 2015 00:00:00 +0000</lastBuildDate>
    <atom:link href="http://tendermint.com/categories/tmsp/index.xml" rel="self" type="application/rss+xml" />
    
    <item>
      <title>The Tendermint Socket Protocol (TMSP)</title>
      <link>http://tendermint.com/posts/tendermint-socket-protocol/</link>
      <pubDate>Sat, 19 Dec 2015 00:00:00 +0000</pubDate>
      
      <guid>http://tendermint.com/posts/tendermint-socket-protocol/</guid>
      <description>

&lt;h3 id=&#34;motivation:9ee5291616336eaccb53b94be2d99fab&#34;&gt;Motivation&lt;/h3&gt;

&lt;p&gt;Thus far, all blockchains have had a monolithic design.  That is, each blockchain app is a single program that handles all the concerns of a decentralized ledger; this includes P2P connectivity, the &amp;ldquo;mempool&amp;rdquo; broadcasting of transactions, consensus on the most recent block, account balances, Turing-complete contracts, user-level permissions, etc.&lt;/p&gt;

&lt;p&gt;This approach to blockchain development has several problems, two of which will be mentioned here.  The first problem is that creating a new blockchain app requires forking an existing blockchain &amp;ldquo;stack&amp;rdquo; (such as &lt;a href=&#34;https://github.com/bitcoin/bitcoin&#34;&gt;Bitcoin&lt;/a&gt;), and this comes with the cost of complexity.  First you need to understand all the components of a blockchain stack, even those that aren&amp;rsquo;t directly relevant to the logic of your application.  This is especially true when the codebase is not modular in design and suffers from &amp;ldquo;spaghetti code&amp;rdquo;.&lt;/p&gt;

&lt;p&gt;The second problem to this approach is that it limits you to the language of the blockchain stack (or vice versa).  In the case of Ethereum which supports a Turing-complete bytecode virtual-machine, it limits you to languages that compile down to that bytecode; today, those are Serpent and Solidity.&lt;/p&gt;

&lt;p&gt;If we could only split a blockchain into two so that a standalone application speaks to the rest of the blockchain via a language-agnostic socket protocol, we wouldn&amp;rsquo;t be limited in this way.  Lo and behold, TMSP is that socket protocol.  Implementing TMSP is the easiest way to develop a new blockchain app.  You don&amp;rsquo;t need to fork a whole blockchain stack, and you can program your application in any language.&lt;/p&gt;

&lt;p&gt;The other half of TMSP is the &lt;a href=&#34;https://github.com/tendermint/tendermint&#34;&gt;Tendermint Core&lt;/a&gt; program (the &amp;ldquo;consensus provider&amp;rdquo;).  Tendermint Core speaks to your TMSP application via a socket connection to empower your application with the best propoerties of blockchains, including optimal Byzantine fault-tolerant consensus, P2P connectivity, transaction mempool, blockchain storage, and more.  Of course, you&amp;rsquo;re not limited to Tendermint Core.  In the future there will likely be different implementations of consensus providers that you can pair your application with.  You&amp;rsquo;re not locked in to Tendermint Core with TMSP.&lt;/p&gt;

&lt;p&gt;As an added benefit, designing your blockchain app to support TMSP is a great way to make your application logic more modular and testable.&lt;/p&gt;

&lt;h3 id=&#34;tmsp-overview:9ee5291616336eaccb53b94be2d99fab&#34;&gt;TMSP Overview&lt;/h3&gt;

&lt;p&gt;The Tendermint Socket Protocol (TMSP) is an asyncronous message passing protocol
enabing a consensus engine, running in one process,
to manage an application state, running in another.&lt;/p&gt;

&lt;p&gt;If you are of sound mind, the consensus engine will be Tendermint,
and regardless of your soundness of mind, your application can be written in any programming language.&lt;/p&gt;

&lt;p&gt;The only requirements we have are that applications be deterministic and implement the TMSP API.&lt;/p&gt;

&lt;p&gt;The API is quite simple, as it boils down to the most basic interface between a consensus engine and its application state: &lt;code&gt;append_tx&lt;/code&gt;, &lt;code&gt;get_hash&lt;/code&gt;, &lt;code&gt;commit&lt;/code&gt;, &lt;code&gt;rollback&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;That is, the consensus engine will receive new txs in the mempool,
and run them through the application using &lt;code&gt;append_tx&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;After a few transactions, the consensus engine can ask for the state hash with &lt;code&gt;get_hash&lt;/code&gt;.
This way, the only thing consensus has to know about the application is the state root hash,
which goes in the block header, so applications can support light client proofs easily.&lt;/p&gt;

&lt;p&gt;When a block is committed, the consensus sends a &lt;code&gt;commit&lt;/code&gt; message, indicating the application should save its latest state.&lt;/p&gt;

&lt;p&gt;Converesely, a &lt;code&gt;rollback&lt;/code&gt; message tells the application to go back to the latest committed state.&lt;/p&gt;

&lt;h3 id=&#34;tutorials:9ee5291616336eaccb53b94be2d99fab&#34;&gt;Tutorials&lt;/h3&gt;

&lt;ul&gt;
&lt;li&gt;&lt;a href=&#34;http://tendermint.com/tutorials/run-your-first-tmsp-application/&#34;&gt;Run your first TMSP application&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://tendermint.com/tutorials/launch-a-tmsp-testnet/&#34;&gt;Launch a TMSP testnet&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
    </item>
    
    <item>
      <title>Launch a TMSP testnet</title>
      <link>http://tendermint.com/tutorials/launch-a-tmsp-testnet/</link>
      <pubDate>Wed, 16 Dec 2015 00:00:00 +0000</pubDate>
      
      <guid>http://tendermint.com/tutorials/launch-a-tmsp-testnet/</guid>
      <description>

&lt;p&gt;&lt;em&gt;This tutorial is second in a series.  See &lt;a href=&#34;http://tendermint.com/posts/introducing-tmsp/&#34;&gt;Introducing TMSP&lt;/a&gt; for links to all the tutorials in this series.&lt;/em&gt;&lt;/p&gt;

&lt;h3 id=&#34;tendermint-core:e6f6bbc740be2f7da0f93ab7574b2f68&#34;&gt;Tendermint Core&lt;/h3&gt;

&lt;p&gt;Now that we&amp;rsquo;ve seen how TMSP works, and even played with a few applications using the &lt;code&gt;tmsp&lt;/code&gt; tool,
let&amp;rsquo;s run an actual Tendermint node.&lt;/p&gt;

&lt;p&gt;When running a live application, a Tendermint node takes the place of the &lt;code&gt;tmsp&lt;/code&gt; tool by sending TMSP requests
to the application: &lt;code&gt;append_tx&lt;/code&gt; when transactions are received by the mempool, &lt;code&gt;commit&lt;/code&gt; when the consensus protocol commits a new block, and so on.&lt;/p&gt;

&lt;p&gt;Installing Tendermint is easy:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;go get github.com/tendermint/tendermint/cmd/tendermint
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you already have Tendermint installed, then you can either set a new &lt;code&gt;$GOPATH&lt;/code&gt; and run the previous command,
or else fetch and checkout the latest master branch in &lt;code&gt;$GOPATH/src/github.com/tendermint/tendermint&lt;/code&gt;,
and from that directory run&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;go get ./cmd/tendermint
go install ./cmd/tendermint
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;To initialize a genesis and validator key in &lt;code&gt;~/.tendermint&lt;/code&gt;, run&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;tendermint init
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You can change the directory by setting the &lt;code&gt;$TMROOT&lt;/code&gt; environment variable.&lt;/p&gt;

&lt;p&gt;Now,&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;tendermint node
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You should see &lt;code&gt;Failed to connect to proxy for mempool: dial tcp 127.0.0.1:46658: getsockopt: connection refused&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;That&amp;rsquo;s because we don&amp;rsquo;t have an application process running, and Tendermint will only run if there&amp;rsquo;s an application it can speak TMSP with.&lt;/p&gt;

&lt;p&gt;So lets start the &lt;code&gt;dummy&lt;/code&gt; app,&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;dummy
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;and in another window, start Tendermint:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;tendermint node
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;After a few seconds you should see blocks start streaming in!&lt;/p&gt;

&lt;p&gt;Now you can send transactions through the Tendermint RPC server with curl requests, or from your browser:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;curl http://localhost:46657/broadcast_tx?tx=\&amp;quot;abcd\&amp;quot;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;For handling responses, we recommend you &lt;a href=&#34;https://stedolan.github.io/jq/&#34;&gt;install the &lt;code&gt;jq&lt;/code&gt; tool&lt;/a&gt; to pretty print the JSON&lt;/p&gt;

&lt;p&gt;We can see the chain&amp;rsquo;s status at the &lt;code&gt;/status&lt;/code&gt; end-point:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;curl http://localhost:46657/status |  jq .
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;and the &lt;code&gt;latest_app_hash&lt;/code&gt; in particular:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;curl http://localhost:46657/status |  jq . | grep app_hash
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;visit &lt;a href=&#34;http://localhost:46657&#34;&gt;http://localhost:46657&lt;/a&gt; in your browser to see the other endpoints.&lt;/p&gt;

&lt;h3 id=&#34;deploy-a-tendermint-testnet:e6f6bbc740be2f7da0f93ab7574b2f68&#34;&gt;Deploy a Tendermint Testnet&lt;/h3&gt;

&lt;p&gt;Now that we&amp;rsquo;ve run a single Tendermint node with one validator and a couple applications,
let&amp;rsquo;s deploy a testnet to run our application with four validators.&lt;/p&gt;

&lt;p&gt;For this part of the tutorial, we assume you have an account at digital ocean and are willing to
pay to start some new droplets to run your nodes. You can of course stop and destroy them at any time.&lt;/p&gt;

&lt;p&gt;To deploy a testnet, use the &lt;code&gt;mintnet&lt;/code&gt; tool:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;go get github.com/tendermint/mintnet
&lt;/code&gt;&lt;/pre&gt;
</description>
    </item>
    
    <item>
      <title>Run your first TMSP application</title>
      <link>http://tendermint.com/tutorials/run-your-first-tmsp-application/</link>
      <pubDate>Wed, 16 Dec 2015 00:00:00 +0000</pubDate>
      
      <guid>http://tendermint.com/tutorials/run-your-first-tmsp-application/</guid>
      <description>

&lt;p&gt;&lt;em&gt;This tutorial is first in a series.  See &lt;a href=&#34;http://tendermint.com/posts/introducing-tmsp/&#34;&gt;Introducing TMSP&lt;/a&gt; for links to all the tutorials in this series.&lt;/em&gt;&lt;/p&gt;

&lt;h3 id=&#34;a-first-example:639016e1af3277f51024e0a6d4712e42&#34;&gt;A First Example&lt;/h3&gt;

&lt;p&gt;Make sure you &lt;a href=&#34;https://golang.org/doc/install&#34;&gt;have Go installed&lt;/a&gt; and &lt;a href=&#34;https://github.com/tendermint/tendermint/wiki/Setting-GOPATH&#34;&gt;put &lt;code&gt;$GOPATH/bin&lt;/code&gt; in your &lt;code&gt;$PATH&lt;/code&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Next, install the &lt;code&gt;tmsp_cli&lt;/code&gt; tool and example applications:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;go get github.com/tendermint/tmsp/cmd/...
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now run &lt;code&gt;tmsp_cli --help&lt;/code&gt; to see the list of commands:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;COMMANDS:
   batch        Run a batch of TMSP commands against an application
   console      Start an interactive console for multiple commands
   echo         Have the application echo a message
   info         Get some info about the application
   set_option   Set an option on the application
   append_tx    Append a new tx to application
   get_hash     Get application Merkle root hash
   commit       Commit the application state
   rollback     Roll back the application state to the latest commit
   help, h      Shows a list of commands or help for one command
   
GLOBAL OPTIONS:
   --address &amp;quot;tcp://127.0.0.1:46658&amp;quot;    address of application socket
   --help, -h                           show help
   --version, -v                        print the version
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The &lt;code&gt;tmsp_cli&lt;/code&gt; tool lets us send TMSP messages to our application, to help build and debug them.&lt;/p&gt;

&lt;p&gt;As you can see, the TMSP API has more than the four messages outlined above
for convenience, configuration, and information purposes, but it remains quite general.&lt;/p&gt;

&lt;p&gt;Let&amp;rsquo;s start a dummy application:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;dummy
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In another terminal, run&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;tmsp_cli echo hello
tmsp_cli info
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;A TMSP application must provide two things:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;a socket server&lt;/li&gt;
&lt;li&gt;a handler for TMSP messages&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;When we run the &lt;code&gt;tmsp_cli&lt;/code&gt; tool we open a new connection to the application&amp;rsquo;s socket server,
send the given TMSP message, and wait for a response.&lt;/p&gt;

&lt;p&gt;The server may be generic for a particular language, and we provide one for Go in &lt;code&gt;tmsp/server&lt;/code&gt;.
There is one for Python in &lt;code&gt;example/python/tmsp/server.py&lt;/code&gt;, but it could use more love.&lt;/p&gt;

&lt;p&gt;The handler is specific to the application, and may be arbitrary,
so long as it is deterministic and conforms to the TMSP interface specification.&lt;/p&gt;

&lt;p&gt;For example, starting the &lt;code&gt;dummy&lt;/code&gt; application in Go looks like:&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-go&#34;&gt;server.StartListener(&amp;quot;tcp://0.0.0.0:46658&amp;quot;, example.NewDummyApplication())
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Where &lt;code&gt;example.NewDummyApplication()&lt;/code&gt; has methods for each of the TMSP messages and &lt;code&gt;server&lt;/code&gt; handles everything else.&lt;/p&gt;

&lt;p&gt;See the dummy app in &lt;code&gt;example/golang/dummy.go&lt;/code&gt;. It simply adds transaction bytes to a merkle tree, hashing when we call &lt;code&gt;get_hash&lt;/code&gt; and saving when we call &lt;code&gt;commit&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;So when we run &lt;code&gt;tmsp_cli info&lt;/code&gt;, we open a new connection to the TMSP server, which calls the &lt;code&gt;Info()&lt;/code&gt; method on the application, which tells us the number of transactions in our merlke tree.&lt;/p&gt;

&lt;p&gt;Now, since every command opens a new connection, we provide the &lt;code&gt;tmsp_cli console&lt;/code&gt; and &lt;code&gt;tmsp_cli batch&lt;/code&gt; commands,
to allow multiple TMSP messages on a single connection.&lt;/p&gt;

&lt;p&gt;Running &lt;code&gt;tmsp_cli console&lt;/code&gt; should drop you in an interactive console for speaking TMSP messages to your application.&lt;/p&gt;

&lt;p&gt;Try running these commands:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;gt; echo hello
&amp;gt; info
&amp;gt; get_hash
&amp;gt; append_tx abc
&amp;gt; info
&amp;gt; get_hash
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Similarly, you could put the commands in a file and run &lt;code&gt;tmsp_cli batch &amp;lt; myfile&lt;/code&gt;.&lt;/p&gt;

&lt;h3 id=&#34;another-example:639016e1af3277f51024e0a6d4712e42&#34;&gt;Another Example&lt;/h3&gt;

&lt;p&gt;Now that we&amp;rsquo;ve got the hang of it, let&amp;rsquo;s try another application, the &amp;ldquo;counter&amp;rdquo; app.&lt;/p&gt;

&lt;p&gt;This application has two modes: &lt;code&gt;serial=off&lt;/code&gt; and &lt;code&gt;serial=on&lt;/code&gt;.&lt;/p&gt;

&lt;p&gt;When &lt;code&gt;serial=on&lt;/code&gt;, transactions must be a big-endian encoded incrementing integer, starting at 0.&lt;/p&gt;

&lt;p&gt;We can toggle the value of &lt;code&gt;serial&lt;/code&gt; using the &lt;code&gt;set_option&lt;/code&gt; TMSP message.&lt;/p&gt;

&lt;p&gt;Let&amp;rsquo;s kill the console and the dummy application, and start the counter app:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;counter
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Again, the code is just&lt;/p&gt;

&lt;pre&gt;&lt;code class=&#34;language-go&#34;&gt;server.StartListener(&amp;quot;tcp://0.0.0.0:46658&amp;quot;, example.NewCounterApplication())
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;where the CounterApplication is defined in &lt;code&gt;example/golang/counter.go&lt;/code&gt;, and implements the TMSP application interface.&lt;/p&gt;

&lt;p&gt;In another window, start the &lt;code&gt;tmsp_cli console&lt;/code&gt;:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;gt; echo hello
&amp;gt; info
&amp;gt; get_hash
&amp;gt; info
&amp;gt; append_tx abc
&amp;gt; get_hash
&amp;gt; set_option serial on
&amp;gt; append_tx def
&amp;gt; append_tx 0x01
&amp;gt; append_tx 0x02
&amp;gt; append_tx 0x05
&amp;gt; info
&amp;gt; commit
&amp;gt; info
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This is a very simple application, but between &lt;code&gt;counter&lt;/code&gt; and &lt;code&gt;dummy&lt;/code&gt;, its easy to see how you can build out arbitrary application states on top of the TMSP.
In the near future, &lt;code&gt;erisdb&lt;/code&gt; of Eris Industries will also run atop TMSP, bringing with it Ethereum-like accounts, the Ethereum virtual-machine, Eris&amp;rsquo;s permissioning scheme, and native contracts extensions.&lt;/p&gt;

&lt;p&gt;But the ultimate flexibility comes from being able to write the application easily in any language.&lt;/p&gt;

&lt;p&gt;We have implemented the counter app in Python:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;cd example/python
python app.py
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;(you&amp;rsquo;ll have to kill the other counter application process).
In another window, run the console and those previous TMSP commands.
You should get the same results as for the Go version.&lt;/p&gt;

&lt;p&gt;Want to write the counter app in your favorite language?! We&amp;rsquo;d be happy to accept the pull request.&lt;/p&gt;

&lt;p&gt;Before continuing, please kill the &lt;code&gt;python app.py&lt;/code&gt; process.&lt;/p&gt;

&lt;p&gt;TODO: write it in Javascript&lt;/p&gt;

&lt;h3 id=&#34;next-steps:639016e1af3277f51024e0a6d4712e42&#34;&gt;Next steps&lt;/h3&gt;

&lt;p&gt;In the next tutorial, we will show how to &lt;a href=&#34;http://tendermint.com/tutorials/launch-a-tmsp-testnet&#34;&gt;launch a TMSP testnet&lt;/a&gt;.&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>